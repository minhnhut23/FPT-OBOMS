classes: {
    return_arrow: {
      style: {
        stroke-dash: 3
      }
    }
    frame: {
      style: {
        fill: '#EAEDF0'
        stroke-width: 1
      }
    }
  }
  shape: sequence_diagram
  User: {
    shape: image
    width: 50
    height: 60
    icon: https://upload.wikimedia.org/wikipedia/commons/5/5b/Robustness_Diagram_Actor.svg
  }
  
  application: "Application"
  apiGateway: "API Gateway"
  TableController: "TableController"
  TableRepository: "TableRepository"
  TableDAO: "TableDAO"
  DB: "Database" {
    shape: cylinder
  }
  User -> application.bar: "1. Create Table Request"
application -> apiGateway.bar: "2. Forward request"
apiGateway -> TableController.bar: "3. Forward to TableController"
TableController -> TableRepository.bar: "4. Validate data"

# Kiểm tra Shop ID
alt: "Shop ID Validation" {
  class: frame

  "Shop ID does not exist": {
    TableRepository -> TableDAO.bar: "5a. Check if Shop ID exists"
    TableDAO -> DB.bar: "6a. Query Shop ID"
    DB.bar -> TableDAO.bar: "7a. Return result"
    TableDAO -> TableRepository.bar: "8a. Throw Exception: 'Shop ID does not exist!'"
    TableRepository -> TableController.bar: "9a. Return error"
    TableController -> apiGateway.bar: "10a. Forward error"
    apiGateway -> application.bar: "11a. Forward error"
    application -> User: "12a. Display error message"
  }

  else: "Shop ID exists" {
    TableRepository -> TableDAO.bar: "5b. Proceed to next validation"
  }
}

# # Kiểm tra Type ID
alt: "Type ID Validation" {
  class: frame

  "Type ID does not exist": {
    TableRepository -> TableDAO.bar: "6b. Check if Type ID exists"
    TableDAO -> DB.bar: "7b. Query Type ID"
    DB.bar -> TableDAO.bar: "8b. Return result"
    TableDAO -> TableRepository.bar: "9b. Throw Exception: 'Type ID does not exist!'"
    TableRepository -> TableController.bar: "10b. Return error"
    TableController -> apiGateway.bar: "11b. Forward error"
    apiGateway -> application.bar: "12b. Forward error"
    application -> User: "13b. Display error message"
  }

  else: "Type ID exists" {
    TableRepository -> TableDAO.bar: "6c. Proceed to next validation"
  }
}

# # Kiểm tra Table Number
# alt: "Table Number Validation" {
#   class: frame

#   "Table Number already exists": {
#     TableRepository -> TableDAO.bar: "7c. Check if Table Number exists"
#     TableDAO -> DB.bar: "8c. Query Table Number"
#     DB.bar -> TableDAO.bar: "9c. Return result"
#     TableDAO -> TableRepository.bar: "10c. Throw Exception: 'Table Number already exists!'"
#     TableRepository -> TableController.bar: "11c. Return error"
#     TableController -> apiGateway.bar: "12c. Forward error"
#     apiGateway -> application.bar: "13c. Forward error"
#     application -> User: "14c. Display error message"
#   }

#   else: "Table Number is available" {
#     TableRepository -> TableDAO.bar: "7d. Proceed to insert table"
#   }
# }

# # Tạo bàn mới
# TableRepository -> TableDAO.bar: "8d. Map DTO and Generate ID"
# TableDAO -> DB.bar: "9d. Insert table data"
# DB.bar -> TableDAO.bar: "10d. Return insert result"

# alt: "Insert Success or Fail" {
#   class: frame

#   "Insert failed": {
#     TableDAO -> TableRepository.bar: "11d. Throw Exception: 'Insert error!'"
#     TableRepository -> TableController.bar: "12d. Return error"
#     TableController -> apiGateway.bar: "13d. Forward error"
#     apiGateway -> application.bar: "14d. Forward error"
#     application -> User: "15d. Display error message"
#   }

#   else: "Insert successful" {
#     TableDAO -> TableRepository.bar: "11e. Fetch inserted table"
#     TableRepository -> TableController.bar: "12e. Return new table data"
#     TableController -> apiGateway.bar: "13e. Forward response"
#     apiGateway -> application.bar: "14e. Forward response"
#     application -> User: "15e. Display success message"
#   }
# }
